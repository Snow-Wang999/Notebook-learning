# 第二章数字图像基础

from 数字图像处理

![image-20221107164520503](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221107164520503.png)

参考知乎专栏

https://www.zhihu.com/column/shuzixinhaochuli

## 图像的概念。像素之间的基本关系。测量距离。

### 1. 图像的概念。

图像可以定义为二维函数 $f(x，y)$，其中x和y是空间（特别是平面上的）坐标，其在坐标对$(x，y)$指定的任何点上的f值称为该点上图像的强度或灰度。如果x、y和f接受有限数量的离散值，则表示数字图像。

### 2. 像素之间的基本关系。

#### 1) 相邻像素

1. 位于坐标$(x,y)$处的像素 $p$ 有4个水平和垂直的相邻像素，其坐标是：
   $(x+1,y),(x-1,y),(x,y+1),(x,y-1)$

   这组像素称之 $p$ 的4邻域，用$N_4$表示。每个像素距$(x,y)$一个单位距离，如果(x,y)位于图像的边界上，则 $p$ 的某些相邻像素位于数字图像的外部。

2. p的4个对角相邻像素的坐标是：
   $(x+1,y+1),(x+1,y-1),(x-1,y+1),(x-1,y-1)$
   用$N_d$表示。这些点与4个邻点一起成为p的8邻域，用$N_8$表示。与前面一样，如果$(x,y)$位于图像的边界上，则$N_d$和$N_8$中的某些邻点会落入图像的外边。

   ![image-20221103115427842](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103115427842.png)

   ![image-20221103115447596](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103115447596.png)

#### 2) 邻接性，连通性，区域和边界

1. ##### 邻接性

   邻接时两个元素之间的关系。
   如下图所示， $q$ 和 $p$ 是4邻接的：

   ![image-20221103115920182](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103115920182.png)

   如下图所示， $q$ 和 $p$ 是对角邻接的：

   ![image-20221103115947032](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103115947032.png)

   如下图所示， $p$ 和周围的八个数都是连接的：

   ![image-20221103120015306](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103120015306.png)

   **邻接的种类**

   相邻只是像素间物理位置$(x, y)$上的关系，再加上像素值（$f(x, y)$）这个变量，就构成像素的其他关系。

   **邻接性**有两个要素：

   - 一个是灰度值$f(x, y)$的邻接性（值域V）、

   - 一个是物理位置$(x, y)$的邻接性（邻域，如$N_4(p)$等）。

   例如，二值图象中，像素值都为1（或都为0）的像素才有可能被称为是邻接的。在一般图像中，可定义一个值域$V$，灰度值集合$V$是0到255中的任一个子集。

   一般我们考虑三种邻接性：

   - **4邻接**：如果点q在$N_4(p)$中，数值在$V$中，则 $q$ 和 $p$ 是4邻接的；他们一定是8邻接。

   - **8邻接**：如果点q在$N_8(p)$中，数值在$V$中，则 $q$ 和 $p$ 是8邻接的；则他们不一定是4邻接。

   - **m邻接**（混合邻接）：满足下列条件的，则具有$V$中数值的 $p$ 和 $q$ 是$m$连接的。

     - 判断条件：下面2个条件满足其中一个即为m邻接:

       - q在p的4邻域中；
       - 在q的对角邻域中，并且p的4邻域和q的4邻域的交集中的值没有来自V中数值的值
         此时p和q称之为m邻接。

     -  m邻接实质：当像素间同时存在4-邻接和8-邻接，**优先采用4-邻接**，屏蔽两个和同一像素间存在4-邻接的像素之间的8-邻接。

     - 目的：混合邻接时，8邻接的改进。混合邻接的引入是为了**消除采用8邻接时产生的二义性**。例如，考虑下图中，对于V={1}的像素排列。为下图b上部的3个像素显示了多重性（二义性）8邻接，如虚线所示。这种二义性可以通过m邻接消除，如下图c位置。

       ![image-20221103120721724](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103120721724.png)

       我们从上面的图可以发现，A到C的方式有两种，分别为A-》B-》C和A-》C。这被称为二义性，这就是为什么要引入m邻接。m邻接可以让像素连接能够消除二义性。

2. ##### 连通性

   1. 反应两个像素的空间关系。

      从具有坐标(x,y)的像素p到具有坐标(s,t)的像素q的通路(或曲线)是特定的像素序列，其坐标为：
      $$
      (x_0,y_0),(x_1,y_1),…,(x_n,y_n)
      $$

      其中$(x_0,y_0)=(x,y),(x_n,y_n)=(s,t)$,且像素 $(x_i,y_i)$ 和$(x_i-1,y_i-1)$对于$1\leq i\leq n$是邻接的。在这种情况下，$n$是通路的长度。如果$(x_0,y_0)=(x_n,y_n)$，则通路是闭合通路，可以依据特定的邻接类型定义4邻接，8邻接或m邻接。

   2. 令S是图像中的一个像素子集。如果S的全部像素之间存在一个通路，则可以说两个像素p和q在S中是连通的。对于S中的任何像素p，S中连通到该像素成为S的连通分量，则S仅有一个连通分量，则集合S称为连通集。

   3. **通俗：**

      <img src="C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103171916848.png" alt="image-20221103171916848" style="zoom: 67%;" />

      > 前提：定义区域时，必须指明灰度相似性准则 V= { };一个区域和其背景中的点之间的邻接要根据8连通来定义。

      - 红线穿过的像素是0像素的8邻接，它构成的路线就叫做**通路。**

      - 同这个例子所示，如果通路是闭合的，就叫做**闭合通路**。

      - 也可以根据邻接性定义，比如这个例子可以叫做**8通路**。

      - 令红线穿过的像素集合为S，那么S中包含的任意两个像素p和q在S中是**连通**的。

      - 对于任意一个属于集合S的像素q，集合S中连通到像素q的像素集成为q的**连通分量**。如果S仅有一个连通分量，则集合S称为**连通集**。

3. ##### 区域

   - 令R为图像的一个像素子集。如果R是连通集，则称R为一个**区域**。
   - 两个区域，如果他们联合形成一个连通集，则区域$R_i$和$R_j$称为**邻接区域**。不邻接的区域称为不连接区域。在谈到区域时候，我们考虑的是4邻接和8邻接。为使我们的定义有意义，必须制定邻接的类型。

   - 假如一幅图像包含有K个不连接的区域，即$R_k,k=1,2,3…,K$，且它们都不接触图像的边界。令$R_u$代表所有K个区域的并集，并且$R_uC$代表其补集。我们称$R_u$中的所有点位图像的**前景**，而成$R_uC$中的所有点为图像的**背景**。

     ![image-20221103173750508](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103173750508.png)

4. ##### 边界

   - 区域R的**边界（边缘或轮廓）**是这样的点集，这些点与R的补集中的点邻近。换一种方式说，一个区域的边界时该区域中至少有一个背景邻点的像素集。这里再强调一下，我们必须制定由于定义邻接的连通性。

————————————————
版权声明：本文为CSDN博主「希森SEASON」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/Charles0512/article/details/104392377

### 3. 测量距离。

#### 定义

设图像元素p，q和z，分别具有坐标（x，y），（s，t）和（v，w）。如果：

1. D(p, q) ≥ 0， (当且仅当p=q时，D(p,q)=0)
2. D(p, q) = D(q, p)，
3. D(p, z) ≤ D(p, q)+D(q, z).

则称D为距离函数或度量。

#### 欧几里得（欧式）距离（Euclidean distance）——二阶范数

像素p(x,y)和q(s,t)间的欧式距离，就是我们在直角坐标系中最常用的两点间的直线距离，定义如下：

![image-20221103174012613](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221103174012613.png)

![image-20221102190010225](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221102190010225.png)

$$
\left[\begin{array}{ccccc}2.8&2.2&2&2.2&2.8\\2.2&1.4&1&1.4&2.2\\2&1&0&1&2\\2.2&1.4&1&1.4&2.2\\2.8&2.2&2&2.2&2.8\end{array}\right]
$$


#### 欧式距离

示意图如下，A与B之间的欧氏距离就是A到B的直线距离：

![image-20221102190033810](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221102190033810.png)

#### D4距离（小区距离[city block distance]）——1阶范数

像素p(x,y)和q(s,t)之间的D4距离定义为：

$D_4(p,q) = |x – s| + |y – t|  $

通俗地来理解，p和q是一座大城市里面的两座房子，在这城市里面的大街上走路只能直走或者90度转弯，从p走到q经过的距离就是城市距离。例如，与点(x,y)（中心点）D4距离小于等于2的所有像素如下图所示：

![image-20221102190112509](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221102190112509.png)

具有D4 = 1的像素是(x,y)的4邻域

D4距离又可以这样理解：从点p向点q出发，每次能走一下个点必须是在当前像素点的4邻域中，一步一步走到q点，一共经过的像素点数就是D4距离

#### D8距离（棋盘距离[chessboard distance]）：

像素p(x,y)和q(s,t)之间的D8距离定义为：

$D_8(p,q) = max(|x – s| ,|y – t|)$

两点之间的棋盘距离就是以这两点为一条对角线的矩形的较长的那条边

例如，与点(x,y)（中心点）D8距离小于等于2的像素，形成如下图所示的中心在(x,y)的正方形

![image-20221102190200062](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221102190200062.png)

具有D8 = 1的像素是(x,y)的8邻域 D8距离又可以这样理解：从点p向点q出发，每次能走一下个点必须是在当前像素点的8邻域中，一步一步走到q点，一共经过的像素点数就是D8距离

https://zhuanlan.zhihu.com/p/73504316



## 中心矩。图像的局部均值和方差的概念。基于局部统计的图像增强。

1. ### 原点矩和中心矩。

   矩(moments)是描述图像特征的算子，被广泛应用于图像检索和识别，以及图像匹配、图像重建、图像压缩及运动图像分析等领域。

   （接下来介绍图像矩的原理。）

   在[数学](https://baike.baidu.com/item/数学/107037?fromModule=lemma_inlink)的概率领域中有一类数字特征叫矩。在实际问题中，要确定某一随机变量的分布往往不是容易的事。在概率论中，矩是用来描述随机变量的某些特征的数字，即求[平均值](https://baike.baidu.com/item/平均值/8353298?fromModule=lemma_inlink)，用大写字母$E$表示。

   在概率论和数学统计学中，除了期望值和方差外，还使用了随机变量的其他数值特征。首先是*原点矩*和*中心矩*。

   - #### 原点矩：

     设$X$和$Y$是随机变量，对于正整数$k$，如果$E(X^k)$存在，且$E(X^k)$<∞，则称$E(X^k)$为随机变量$X$的$k$阶原点矩，简称$k$阶矩。如$X$的期望是$X$的一阶原点矩，即$D(X)=E(X)=\int_{-\infty}^{+\infty}xf(x)dx$

   - #### 中心矩：

     对于正整数$k$，如果$E(X)$存在，且$E[X-E(X)]^k<∞$，则称$E[[X-E(X)]^k]$为随机变量$X$的$k$阶中心矩。
     $$
     \mu_k=E[X-E(X)]^k=\int_{-\infty}^{+\infty}(x-\mu)^kf(x)dx
     $$

     - $X$的一阶中心距：等于0。

     - $X$的二阶中心矩：$X$的方差，即
       $$
       D(X)=Var(X)=E{[X-E(X)]^2}=\int_{-\infty}^{+\infty}(x-\mu)^2f(x)dx
       $$
        [1](张远达. 线性代数原理[M]. 上海教育出版社, 1980.)

     - $X$的三阶中心距：偏度（Skewness），反映总体分布的“非对称性”或“偏倚性”。跟“偏度因子”是有关的。要记住带“因子/系数”的都是无量纲的，怎样消除的量纲呢，也很简单，对于三阶中心矩，除以标准差的三次方，即可消除量纲。
       $$
       S(X)=E{[X-E(X)]^3}=\int_{-\infty}^{+\infty}(x-\mu)^3f(x)dx
       $$

     - $X$的四阶中心距：峭度或峰度（Kurtosis），反映总体分布陡峭或平滑的程度。峭度因子是消除量纲后的峭度，方法是除以标准差的四次方。
       $$
       K(X)=E{[X-E(X)]^4}=\int_{-\infty}^{+\infty}(x-\mu)^4f(x)dx
       $$

   - #### 混合矩：

     对于正整数$k,l$，如果$E(X^kY^l)$存在，则称它为$X$ 和 $Y$ 的 $k+l$ 阶混合矩。

   - #### 混合中心矩：

     对于正整数$k,l$，如果存在$E\{[X-E(X)]^k[Y-E(Y)]^l\}$，则称它为$X$ 和 $Y$ 的 $k+l$ 阶混合中心矩。

   - #### 常见矩的含义

     |    名称    |   含义   |
     | :--------: | :------: |
     | 一阶原点矩 |  平均值  |
     | 二阶原点矩 | 平均能量 |
     | 零阶中心距 |    1     |
     | 一阶中心矩 |    0     |
     | 二阶中心矩 |   方差   |
     | 三阶中心矩 |   偏度   |
     | 四阶中心矩 |   峭度   |

2. ### 中心距的性质：

   - 中心距具有平移不变性。对于任意的随机变量X和任意常数c，恒有：
     $$
     \mu_n(X+c)=\mu_n(X)
     $$

   - n阶中心矩是n次齐次函数。
     $$
     \mu_n(cX)=c^n\mu_n(X)
     $$

   - 只有当$n\in\{1,2,3\}$，且X和Y为两个互相[独立](https://baike.baidu.com/item/独立/3415220?fromModule=lemma_inlink)的随机变量时，中心矩才具有加法性。
     $$
     \mu_n(X+Y)=\mu_n(X)+\mu_n(Y)
     $$

   - $\kappa_n$另一个与中心矩类似，但在 $n\geq4$时仍保有加法性的统计量为n阶累积量。

3. ### 图像的矩

   [什么叫图像或轮廓的空间矩、中心矩、归一化中心矩？并利用OpenCV的类Moments计算轮廓的这几个矩和质心位置](https://www.pudn.com/news/627cc5e35981aa38ef8542dc.html#central_moments_35)

   ### 3.1 图像空间矩（spatial moments）

   图像空间矩（spatial moments）的计算公式如下：
   $$
   m_{ij}= \sum_{x,y}{array(x,y)\cdot x^j \cdot y^i}
   $$
   
   其中，$array(x,y)$是像素$(x,y)$处的像素值。
   
   注意：x代表的是像素的列号，而不是行号；y代表的是像素的行号，而不是列号。
   
   图像的空间矩不仅与像素值大小有关，还与像素的位置有关。
   
   当 $j = i = 0$时，图像的零阶空间矩$m_{00}$实际上就是所有像素值的累加，零阶矩的值与像素的位置无关。
   
   图像的一阶空间矩$m_{10}$或者$m_{01}$在空间位置上只与像素的行号或列号有关。
   
   k阶空间矩：$k=\sqrt{j^2+i^2}$
   
   #### 3.2 图像中心矩（central moments）
   
   图像的中心距的计算式如下：
   $$
   mu_{ji}=\sum_{x,y}{(array(x,y) \cdot (x-\bar{x})^j \cdot (y-\bar{y})^i)}
   $$
   式中 $x-\bar{x}$ 和 $y-\bar{y}$

   $mu_{00}=m_{00}$       $mu_{01}=mu_{10}=0$
   
   3.3 图像归一化的中心矩（normalized central moments）
   
   图像归一化的中心矩的计算式如下：
   
   $nu_{ji}=\frac{mu_{ji}}{m_{00}^{(i+j)/2+1}}$
   
   $nu_{00}=1$
   
   $nu_{10}=nu_{01}=0$
   
3. ### 矩估计法

   **矩估计，即矩估计法，也称“矩法估计”，就是利用样本矩来估计总体中相应的参数。**

   矩估计法是由英国统计学家皮尔逊（K.Pearson）在1894年提出。

   [点估计及矩估计的一些理解](https://blog.csdn.net/huguozhiengr/article/details/81607637)

   #### 1）矩估计法的基本思想：

   - 用样本的$k$阶原点矩$A_k=\frac{1}{n}\sum_{i=1}^{n}{X_i^k}$ 去估计总体$X$的 $k$ 阶原点矩$E(X^k)$。——点估计

   - 用样本的$k$阶中心矩$B_k=\frac{1}{n}\sum_{i=1}^{n}{(X-\overline{X})^k}$ 去估计总体$X$的 $k$ 阶中心矩$E[X-E(X)]^k$。$\overline{X}$ 为样本均值。

     并由此得到未知参数的估计量。

   #### 2）矩估计法的步骤

   - 首先推导涉及相关参数的总体矩（即所考虑的随机变量的幂的期望值）的方程。然后取出一个样本并从这个样本估计总体矩。接着使用样本矩取代（未知的）总体矩，解出感兴趣的参数。从而得到那些参数的估计。

   #### 3）总体为连续分布or离散分布

   - 当总体为连续分布时，设$f(x,\theta)$ 为总体分布的概率密度函数，$\theta$为总体分布中的待估参数（假设此处总体分布中只有一个待估参数$\theta$），则总体的k阶原点矩$\alpha _{k}$、k阶中心距$\mu_{k}$分别定义为如下形式
     $$
     \alpha _{k}=\int_{-\infty}^{+\infty}x^kf(x,\theta)dx
     $$

     $$
     \mu _{k}=\int_{-\infty}^{+\infty}(x-E(X))^kf(x,\theta)dx
     $$

   - 当总体为离散分布时，设$P(X=X_{i},\theta )$是 $X=X_{i}$ 时的概率，则总体的k阶原点矩$\alpha _{k}$、k阶中心距分$\alpha _{k}$别定义为如下形式
     $$
     \alpha _{k}=E(X^k)=\sum_{i=1}^{n}{X_i^kP(X=X_{i},\theta )}
     $$

     $$
     \mu _{k}=E(X-E(X))^k=\sum_{i=1}^{n}{E(X_i-E(X))^kP(X=X_{i},\theta )}
     $$

     

   #### 4）无偏估计or非无偏估计

   - 在用样本矩估计总体矩时，我们还需要知道样本矩对总体矩而言是无偏估计，还是非无偏估计，这样有助于我们把握估计偏差，下面以样本一阶原点矩$a _{n1}$、二阶中心矩$m _{n2}$为例来估计总体的一阶原点矩$\alpha _{1}$和$\mu_{2}$，观察它们是否为无偏估计
     $$
     E(a_{n1})=\frac{1}{n}\sum_{i=1}^{n}{E(X)}=\alpha_1
     $$

     $$
     E(m_{k2})=\frac{1}{n}E(\sum_{i=1}^{n}{(X_i-\overline{X_n})^2})
     $$

     $$
     \mu_2=\sum_{i=1}^{n}{(X_i-E(X))^2P(X=X_{i},\theta )}
     $$

     $$
     E(m_{k2})=\frac{n-1}{n}\mu_2
     $$

     可以看到，样本的二阶中心矩并非总体的二阶中心矩的无偏估计，但是我们可以采用因子$\frac{n-1}{n}$来调整这个估计偏差，但一般在应用上不去做调整而是容忍一些偏差存在，**在n较大时，这个偏差对于应用无损**。

   #### 5）应用意义

   - 期望（Expectation）：反映了总体分布的集中趋势，反映了总体分布中欧给大量数据向某一方向集中的情况，利用总体期望值可以对两个总体的差异进行比较。
   - 方差（Variance）：反映了一组数据与其平均值的偏离程度。反映总体分布的波动大小。
   - 偏度（Skewness）：$\beta_1=\mu_3/\mu_2^{2/3}$，反映总体分布的“非对称性”或“偏倚性”

   - 峰度（Kurtosis）  ：$\beta _{2}=\mu _{4}/\mu _{2}^{2}$ ，反映总体分布陡峭或平滑的程度

4. ### 图像的局部均值和方差的概念。

   https://zhuanlan.zhihu.com/p/73546610

   从简单的讲，一张只有灰度值的$M \times N$大小的照片，令 $z_i,i=0,1,2,⋯,L−1$ 表示这一幅$M \times N$大小图像中所有的可能的灰度值，那么这张图片中出现灰度级$Z_k$的概率$p(Z_k)$就是：
   $$
   p(z_k)=\frac{n_k}{MN}
   $$

   > 其中，$n_k$ 就表示$Z_k$ 这个灰度级出现的次数，$MN$表示整张图的像素图。

   显然，所有灰度值的概率和应该为1：
   $$
   \sum_{k=0}^{L-1}{p(z_k)}=1
   $$
   知道了$p(z_k)$，就有好多概念可以表示了：

   - 平均灰度：$m=\sum_{k=0}^{L-1}{z_{k}p(z_k)}$
   - 灰度方差：$\sigma_2=\sum_{k=0}^{L-1}{(z_k-m)^2p(z_k)}$
   - n阶矩：$\mu_n(z)=\sum_{k=0}^{L-1}{(z_k-m)^{n}p(z_k)}$

1. ### 基于局部统计的图像增强。

   https://www.docin.com/p-379956212.html
   
   摘自《基于图像统计信息的局部增强-赵雪英，汪江》

   

   图像的空间域增强是图像增强技术的一大类方法，该方法直接对图像像素进行处理，基本以灰度映射变换为基础，常见的空间域增强可分为全局增强和局部增强。本文介绍几种常用的局部增强算法。局部增强是增强图像小区域的细节。

   #### 1）自适应直方图均衡算法（AHE）[2]
   
   Pizer提出的一种局部直方图均衡（HE）算法。算法对图像中的每一个像素都采用大小相同的滑动窗口，然后在该窗口内进行HE，以实现对窗口中心像素的处理，由于该算法对每个滑动窗口都做HE，因此运算量很大。
   
   局部改进基于全局转换，转换功能基于图像每个像素区域的灰度分布。
   
   首先定义一个区域并将区域中心从一个像素移动到另一个像素。在每个位置上，计算字段中点的直方图，并生成直方图对齐或指定的转换函数。最后，此功能用于显示字段中心像素的灰色阴影。然后，字段的中心移动到相邻像素的位置，过程重复。
   
   #### 2）局部对比度增强计算公式（Lee Jongsan）[3]
   
   计算公式：
   $$
   x_{i,j}'=m_{i,j}+k(x_{i,j}-m_{i,j})
   $$
   式中，
   $$
   m_{i,j}=\frac{1}{m\times n}\sum_{(i,j)\in W}{x_{i,j}}
   $$
   $m_{i,j}$为窗口W内的灰度平均值，$x_{i,j}, x_{i,j}'$ 分别为变换前、后中心像素的灰度值。
   
   ![image-20221104220101557](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104220101557.png)
   
   #### 3）宋刚对算法（2）进行改进 [4]
   
   $$
   x_{i,j}'=\begin{cases}H(x_{i,j})+k'(\frac{\sigma_{i,j}^2}{\sigma_{i,j}}-1)(x_{i,j}-m_{i,j})\\H(x_{i,j}),其他 \end{cases}
   $$
   
   $x_{i,j}, x_{i,j}'$ 分别为变换前、后中心像素的灰度值。$H(x_{i,j})$ 为灰度值查找表，$k'$ 为比例常数，可根据图像中的噪声情况而定，$\sigma_{i,j}^2$ 为窗口内灰度方差，$\sigma_{n}^2$ 为整幅图像的灰度方差，$m_{i,j}$ 为窗口内灰度均值，该算法能够同时强化细节，增强整幅图像对比度并能抑制噪声，用于处理模糊文字及细节较多的图像效果较佳
   
   #### 4）曹聚亮提出的自适应局部灰度修正的HE算法 [5]
   
   该算法对原图像和经HE处理后图像的梯度值进行计算并比较，确定梯度显著减小处像素位置，然后参照原图像中这些像素点处的梯度值，修正该像素的灰度值，增强其局部梯度，从而有效地保留该点的图像细节信息，该算法：
   $$
   x_{i,j}'=\begin{cases}x_{i,j}^{HE}+k'(\frac{\sigma_{i,j}^2}{\sigma_{n}^2}-1)(x_{i,j}-m_{i,j}),|d_{i,j}^{HE}|<s|d_{i,j}|\\x_{i,j}, |d_{i,j}^{HE}|\geq s|d_{i,j}| \end{cases}
   $$
   ![image-20221104222235610](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104222235610.png)
   
   ![image-20221104222252331](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104222252331.png)
   
   #### 5）全局自适应均衡与局部动态放大相结合的对比度增强算法 [6]
   
   $$
   g(m,n)=\alpha DM+(1-\alpha)histV(f(m,n))+\frac{f(m,n)-M(m,n)}{\frac{\sigma^2(m,n)}{DS}+\frac{1}{Max(M(m,n))}}
   $$
   
   ![image-20221104222718668](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104222718668.png)
   
   
   
   熵：
   $$
   H=-\sum_{i=0}^{L-1}{p_i\ln p_i}
   $$
   ![image-20221104223151403](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104223151403.png)
   
   ![image-20221104223233127](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104223233127.png)
   
   ![image-20221104223245082](C:\Users\Myste\AppData\Roaming\Typora\typora-user-images\image-20221104223245082.png)